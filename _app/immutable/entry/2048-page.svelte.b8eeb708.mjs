var j=Object.defineProperty;var q=(r,e,t)=>e in r?j(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var R=(r,e,t)=>(q(r,typeof e!="symbol"?e+"":e,t),t);import{S as N,i as O,s as W,k as _,q as b,a as D,l as A,m as v,r as F,h as c,c as k,n as T,b as w,G as d,J as I,H as E,K as S,u as V}from"../chunks/index.dedc0292.mjs";class Y{constructor(){R(this,"gameArray");R(this,"numFilled");R(this,"won");this.gameArray=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.numFilled=0,this.won=!1,this.genRandomTile(),this.genRandomTile()}genRandomTile(){let e=Math.floor(Math.random()*(16-this.numFilled)),t=Math.random()<.1?4:2,s=-1;for(let l=0;l<this.gameArray.length;l++)for(let i=0;i<this.gameArray[0].length;i++)this.gameArray[l][i]===0&&s++,s===e&&(this.gameArray[l][i]=t,this.numFilled++,l=100,i=100)}restart(){this.gameArray=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.numFilled=0,this.won=!1,this.genRandomTile(),this.genRandomTile()}lost(){let e=structuredClone(this.gameArray),t=this.numFilled;return e=this.move(e),e=this.transposeArray(this.flipArrayLR(this.move(this.flipArrayLR(this.transposeArray(e))))),t===this.numFilled?!0:(this.numFilled=t,!1)}doMove(e){if(e==="d")this.gameArray=this.move(this.gameArray);else if(e==="a")this.gameArray=this.flipArrayLR(this.flipArrayUD(this.move(this.flipArrayUD(this.flipArrayLR(this.gameArray)))));else if(e==="w")this.gameArray=this.transposeArray(this.flipArrayLR(this.move(this.flipArrayLR(this.transposeArray(this.gameArray)))));else if(e==="s")this.gameArray=this.transposeArray(this.flipArrayUD(this.move(this.flipArrayUD(this.transposeArray(this.gameArray)))));else return;this.genRandomTile()}move(e){for(let t=0;t<e.length;t++){let s=-1,l=-1,i=-1;for(let o=e[0].length-1;o>=0;o--)e[t][o]!=0&&(e[t][o]===s?(e[t][o]*=2,e[t][o]===2048&&(this.won=!0),e[l][i]=0,this.numFilled--,s=-1):(s=e[t][o],l=t,i=o))}for(let t=0;t<e.length;t++){let s=e[0].length-1;for(let l=e[0].length-1;l>=0;l--)if(e[t][l]!=0){let i=e[t][l];e[t][l]=0,e[t][s]=i,s--}}return e}transposeArray(e){for(let t=0;t<e.length;t++)for(let s=t;s<e[0].length;s++){let l=e[t][s];e[t][s]=e[s][t],e[s][t]=l}return e}flipArrayLR(e){for(let t=0;t<e.length;t++)for(let s=0,l=e[0].length-1;s<Math.ceil(e[0].length/2);s++,l--){let i=e[t][s];e[t][s]=e[t][l],e[t][l]=i}return e}flipArrayUD(e){for(let t=0;t<e.length;t++)for(let s=0,l=e[0].length-1;s<Math.ceil(e[0].length/2);s++,l--){let i=e[s][t];e[s][t]=e[l][t],e[l][t]=i}return e}}function L(r,e,t){const s=r.slice();return s[6]=e[t],s[8]=t,s}function M(r,e,t){const s=r.slice();return s[6]=e[t],s[10]=t,s}function G(r){let e,t=(r[0][r[8]][r[10]]===0?"":r[0][r[8]][r[10]])+"",s;return{c(){e=_("div"),s=b(t),this.h()},l(l){e=A(l,"DIV",{class:!0});var i=v(e);s=F(i,t),i.forEach(c),this.h()},h(){T(e,"class","col svelte-x5ytso")},m(l,i){w(l,e,i),d(e,s)},p(l,i){i&1&&t!==(t=(l[0][l[8]][l[10]]===0?"":l[0][l[8]][l[10]])+"")&&V(s,t)},d(l){l&&c(e)}}}function P(r){let e,t,s=Array(4),l=[];for(let i=0;i<s.length;i+=1)l[i]=G(M(r,s,i));return{c(){e=_("div");for(let i=0;i<l.length;i+=1)l[i].c();t=D(),this.h()},l(i){e=A(i,"DIV",{class:!0});var o=v(e);for(let n=0;n<l.length;n+=1)l[n].l(o);t=k(o),o.forEach(c),this.h()},h(){T(e,"class","row svelte-x5ytso")},m(i,o){w(i,e,o);for(let n=0;n<l.length;n+=1)l[n].m(e,null);d(e,t)},p(i,o){if(o&1){s=Array(4);let n;for(n=0;n<s.length;n+=1){const p=M(i,s,n);l[n]?l[n].p(p,o):(l[n]=G(p),l[n].c(),l[n].m(e,t))}for(;n<l.length;n+=1)l[n].d(1);l.length=s.length}},d(i){i&&c(e),S(l,i)}}}function C(r){let e,t=r[2]?"You won!":"Game over :(",s,l,i,o,n,p;return{c(){e=_("p"),s=b(t),l=D(),i=_("button"),o=b("Play again?")},l(f){e=A(f,"P",{});var h=v(e);s=F(h,t),h.forEach(c),l=k(f),i=A(f,"BUTTON",{});var m=v(i);o=F(m,"Play again?"),m.forEach(c)},m(f,h){w(f,e,h),d(e,s),w(f,l,h),w(f,i,h),d(i,o),n||(p=I(i,"click",r[4]),n=!0)},p(f,h){h&4&&t!==(t=f[2]?"You won!":"Game over :(")&&V(s,t)},d(f){f&&c(e),f&&c(l),f&&c(i),n=!1,p()}}}function B(r){let e,t,s,l,i,o,n,p,f=Array(4),h=[];for(let a=0;a<f.length;a+=1)h[a]=P(L(r,f,a));let m=r[1]&&C(r);return{c(){e=_("div"),t=_("p"),s=b("Use WASD to play."),l=D(),i=_("div");for(let a=0;a<h.length;a+=1)h[a].c();o=D(),m&&m.c(),this.h()},l(a){e=A(a,"DIV",{class:!0});var g=v(e);t=A(g,"P",{});var u=v(t);s=F(u,"Use WASD to play."),u.forEach(c),l=k(g),i=A(g,"DIV",{class:!0});var y=v(i);for(let U=0;U<h.length;U+=1)h[U].l(y);y.forEach(c),o=k(g),m&&m.l(g),g.forEach(c),this.h()},h(){T(i,"class","grid svelte-x5ytso"),T(e,"class","game svelte-x5ytso")},m(a,g){w(a,e,g),d(e,t),d(t,s),d(e,l),d(e,i);for(let u=0;u<h.length;u+=1)h[u].m(i,null);d(e,o),m&&m.m(e,null),n||(p=I(window,"keydown",r[3]),n=!0)},p(a,[g]){if(g&1){f=Array(4);let u;for(u=0;u<f.length;u+=1){const y=L(a,f,u);h[u]?h[u].p(y,g):(h[u]=P(y),h[u].c(),h[u].m(i,null))}for(;u<h.length;u+=1)h[u].d(1);h.length=f.length}a[1]?m?m.p(a,g):(m=C(a),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},i:E,o:E,d(a){a&&c(e),S(h,a),m&&m.d(),n=!1,p()}}}function H(r,e,t){let s=new Y,l=s.gameArray,i=!1,o=!1;function n(f){s.doMove(f.key),t(0,l=s.gameArray),s.numFilled===16&&s.lost()&&(t(2,o=!1),t(1,i=!0)),s.won&&(t(2,o=!0),t(1,i=!0))}function p(){s.restart(),t(0,l=s.gameArray),t(1,i=!1),t(2,o=!1)}return[l,i,o,n,p]}class z extends N{constructor(e){super(),O(this,e,H,B,W,{})}}export{z as default};
